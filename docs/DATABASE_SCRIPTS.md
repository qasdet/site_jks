# –°–∫—Ä–∏–ø—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç Python —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è Flask.

## üìÅ –î–æ—Å—Ç—É–ø–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã

### 1. `update_database.py` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª—è–µ—Ç –Ω–æ–≤—ã–µ –ø–æ–ª—è –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ –¥–∞–Ω–Ω—ã—Ö.

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
python update_database.py
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –î–æ–±–∞–≤–ª—è–µ—Ç –ø–æ–ª–µ `image_url` –≤ —Ç–∞–±–ª–∏—Ü—É `forum_topic` –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å—Å—ã–ª–æ–∫ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- –î–æ–±–∞–≤–ª—è–µ—Ç –ø–æ–ª–µ `parent_id` –≤ —Ç–∞–±–ª–∏—Ü—É `forum_post` –¥–ª—è –¥—Ä–µ–≤–æ–≤–∏–¥–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
- –î–æ–±–∞–≤–ª—è–µ—Ç –ø–æ–ª—è `updated_at` –≤ —Ç–∞–±–ª–∏—Ü—ã `post` –∏ `forum_post`
- –î–æ–±–∞–≤–ª—è–µ—Ç –ø–æ–ª—è `created_at` –≤–æ –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã
- –î–æ–±–∞–≤–ª—è–µ—Ç –ø–æ–ª–µ `is_active` –≤ —Ç–∞–±–ª–∏—Ü—É `user`
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### 2. `reset_database.py` - –ü–æ–ª–Ω—ã–π —Å–±—Ä–æ—Å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ—Å–æ–∑–¥–∞–µ—Ç –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö —Å –Ω—É–ª—è.

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
python reset_database.py
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –£–¥–∞–ª—è–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
- –°–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö —Å–æ –≤—Å–µ–º–∏ —Ç–∞–±–ª–∏—Ü–∞–º–∏
- –°–æ–∑–¥–∞–µ—Ç –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –î–æ–±–∞–≤–ª—è–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å, –ø–æ—Å—Ç, —Ç–µ–º–∞ —Ñ–æ—Ä—É–º–∞)

**‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ:** –≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç —É–¥–∞–ª—è–µ—Ç –≤—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ!

### 3. `backup_database.py` - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã–º–∏ –∫–æ–ø–∏—è–º–∏

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–æ–∑–¥–∞–Ω–∏–µ, –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã–º–∏ –∫–æ–ø–∏—è–º–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**

#### –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏:
```bash
python backup_database.py backup
```

#### –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–ø–∏—Å–∫–∞ —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π:
```bash
python backup_database.py list
```

#### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏:
```bash
python backup_database.py restore app_backup_20241201_143022.db
```

#### –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π (–æ—Å—Ç–∞–≤–∏—Ç—å 5 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö):
```bash
python backup_database.py cleanup 5
```

#### –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º:
```bash
python backup_database.py
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –°–æ–∑–¥–∞–µ—Ç —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ –≤ –ø–∞–ø–∫–µ `backups/`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ –∫ –∏–º–µ–Ω–∞–º —Ñ–∞–π–ª–æ–≤
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–∞–∑–º–µ—Ä –∏ –¥–∞—Ç—É —Å–æ–∑–¥–∞–Ω–∏—è —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π
- –°–æ–∑–¥–∞–µ—Ç —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é –ø–µ—Ä–µ–¥ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ–º
- –£–¥–∞–ª—è–µ—Ç —Å—Ç–∞—Ä—ã–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –º–µ—Å—Ç–∞

## üóÇÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü—ã:

1. **user** - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–∏—Å—Ç–µ–º—ã
   - `id` (INTEGER, PRIMARY KEY)
   - `username` (VARCHAR(80), UNIQUE)
   - `email` (VARCHAR(120), UNIQUE)
   - `password_hash` (VARCHAR(128))
   - `created_at` (DATETIME)
   - `is_active` (BOOLEAN)

2. **post** - –ü–æ—Å—Ç—ã –±–ª–æ–≥–∞
   - `id` (INTEGER, PRIMARY KEY)
   - `title` (VARCHAR(200))
   - `content` (TEXT)
   - `created_at` (DATETIME)
   - `updated_at` (DATETIME)
   - `user_id` (INTEGER, FOREIGN KEY)

3. **property** - –°–æ–±—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å/–∫–≤–∞—Ä—Ç–∏—Ä—ã
   - `id` (INTEGER, PRIMARY KEY)
   - `number` (VARCHAR(20), UNIQUE)
   - `area` (FLOAT)
   - `owner_id` (INTEGER, FOREIGN KEY)
   - `created_at` (DATETIME)

4. **voting** - –ì–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è
   - `id` (INTEGER, PRIMARY KEY)
   - `title` (VARCHAR(200))
   - `description` (TEXT)
   - `question` (VARCHAR(500))
   - `start_date` (DATETIME)
   - `end_date` (DATETIME)
   - `is_active` (BOOLEAN)
   - `created_by` (INTEGER, FOREIGN KEY)
   - `created_at` (DATETIME)

5. **voting_option** - –í–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤ –¥–ª—è –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è
   - `id` (INTEGER, PRIMARY KEY)
   - `text` (VARCHAR(200))
   - `voting_id` (INTEGER, FOREIGN KEY)

6. **vote** - –ì–æ–ª–æ—Å–∞
   - `id` (INTEGER, PRIMARY KEY)
   - `voting_id` (INTEGER, FOREIGN KEY)
   - `property_id` (INTEGER, FOREIGN KEY)
   - `option_id` (INTEGER, FOREIGN KEY)
   - `voted_at` (DATETIME)

7. **forum_topic** - –¢–µ–º—ã —Ñ–æ—Ä—É–º–∞
   - `id` (INTEGER, PRIMARY KEY)
   - `title` (VARCHAR(200))
   - `image_url` (VARCHAR(500)) - **–ù–û–í–û–ï –ü–û–õ–ï**
   - `created_at` (DATETIME)
   - `user_id` (INTEGER, FOREIGN KEY)

8. **forum_post** - –°–æ–æ–±—â–µ–Ω–∏—è —Ñ–æ—Ä—É–º–∞
   - `id` (INTEGER, PRIMARY KEY)
   - `content` (TEXT)
   - `created_at` (DATETIME)
   - `updated_at` (DATETIME)
   - `user_id` (INTEGER, FOREIGN KEY)
   - `topic_id` (INTEGER, FOREIGN KEY)
   - `parent_id` (INTEGER, FOREIGN KEY) - –¥–ª—è –¥—Ä–µ–≤–æ–≤–∏–¥–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤

## üîß –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –ø–æ—Ä—è–¥–æ–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

1. **–ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ:**
   ```bash
   python reset_database.py
   ```

2. **–ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π (–∫–∞–∫ —Å–µ–π—á–∞—Å —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏):**
   ```bash
   python update_database.py
   ```

3. **–†–µ–≥—É–ª—è—Ä–Ω–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   ```bash
   python backup_database.py backup
   ```

4. **–ü–µ—Ä–µ–¥ –∫—Ä—É–ø–Ω—ã–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏:**
   ```bash
   python backup_database.py backup
   # ... –≤—ã–ø–æ–ª–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è ...
   python update_database.py
   ```

## üö® –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

- **–í—Å–µ–≥–¥–∞ —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é** –ø–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º `reset_database.py`
- –°–∫—Ä–∏–ø—Ç `update_database.py` –±–µ–∑–æ–ø–∞—Å–µ–Ω –∏ –Ω–µ —É–¥–∞–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ
- –†–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ø–∞–ø–∫–µ `backups/`
- –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ `instance/app.db`

## üêõ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞ "no such column"
–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –æ—à–∏–±–∫–∞ –æ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–µ–º –ø–æ–ª–µ, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
```bash
python update_database.py
```

### –ü–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
–ï—Å–ª–∏ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∞:
```bash
python backup_database.py list
python backup_database.py restore <–∏–º—è_—Ñ–∞–π–ª–∞_—Ä–µ–∑–µ—Ä–≤–Ω–æ–π_–∫–æ–ø–∏–∏>
```

### –ü–æ–ª–Ω—ã–π —Å–±—Ä–æ—Å
–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –Ω–∞—á–∞—Ç—å —Å —á–∏—Å—Ç–æ–≥–æ –ª–∏—Å—Ç–∞:
```bash
python reset_database.py
``` 